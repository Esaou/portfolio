{% extends "/frontoffice/base.html.twig" %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}

    <article class="container p-4 pt-3">
        <h4 class="text-left text-black mb-4">{{ post.title }}</h4>
        <hr>
        <p class="pt-4">{{ post.chapo }}</p>
        <p class="pt-4 pb-4">{{ post.content }}</p>
        <hr>
        <div class="blocBtnUpdate" style="margin-top: 10px;">
            <div>
                {% if previousPost is not null %}
                    <a href="index.php?action=post&id={{ previousPost }}" class="subtitle" style="margin: 0px;margin-right: 7px;">Post précédent</a>
                    {% else %}
                    <button type="button" disabled class="subtitle" style="margin: 0px;margin-right: 7px;color: rgb(120,120,120);">Post précédent</button>
                {% endif%}
                {% if nextPost is not null %}
                    <a href="index.php?action=post&id={{ nextPost }}" class="subtitle" style="margin: 0px;margin-right: 7px;">Post suivant</a>
                {% else %}
                    <button type="button" disabled class="subtitle" style="margin: 0px;margin-right: 7px;color: rgb(120,120,120);">Post suivant</button>
                {% endif%}
            </div>
            <div>
                Publié par <span class="text-blue">{{ post.user.firstname }} {{ post.user.lastname }}</span>
                - {% if post.updatedAt is not null %}
                Modifié le {{ post.updatedAt|date('d/m/Y') }} à {{ post.updatedAt|date('H') }}h{{ post.updatedAt|date('i') }}
                {% else %}
                    Créé le {{ post.createdAt|date('d/m/Y') }} à {{ post.createdAt|date('H') }}h{{ post.createdAt|date('i') }}
                {% endif %}
            </div>
        </div>
    </article>

    <section class="container p-4">
        <h4 class="text-left text-black mb-4">Commentaires {% if session.user is not defined %}<small style="font-size: 17px;font-weight: normal;">(connectez-vous pour laisser un commentaire)</small>{% endif %}</h4>
        <hr>
        {% if session.user %}
        <form class="formComment mb-3" action="index.php?action=post&id={{ post.id_post }}" method="POST">
            <input type="hidden" name="token" id="token" value="{{ token }}"/>
            <div class="form-group col-12">
                <label for="comment">Mon commentaire</label>
                <textarea required style="min-height: 200px;" class="form-control" name="comment" id="comment"></textarea>
            </div>
            <div class="submitComment w-100 m-0 pt-3">
                <button type="submit" class="subtitle m-0">Envoyer</button>
            </div>
        </form>
        {% endif %}
        {% if comments %}
            {% for comment in comments %}
                <div class="blocShowOneComment mb-3 pt-4">
                    <div class="pb-3 text-blue">{{ comment.user.firstname }} {{ comment.user.lastname }}</div>
                    <div class="pb-3">{{ comment.comment }}</div>
                    <div class="w-100 blocBtnCreated">
                            <i class="far fa-check-circle" style="margin-right: 10px"></i>
                        <div>Posté le {{ comment.createdAt|date('d/m/Y') }} à {{ comment.createdAt|date('H') }}h{{ comment.createdAt|date('i') }}</div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <h5 class="text-black text-center p-4 pb-4">Aucun commentaires</h5>
        {% endif %}

        <p class="text-black paginator text-center" style='font-size:18px;margin-bottom:30px;margin-top:30px;'>
            {% if pagesTotales > 0 and pagesTotales != 1 %}
                {% for i in 1.. pagesTotales %}
                    {% if i == 1 and pageCourante >= 4 %}
                        <a href='index.php?action=post&page={{ i }}&id={{ post.id_post }}' style='margin:5px;text-decoration:none;'>{{ i }}</a>
                    {% endif %}
                    {% if i == 1 and pageCourante >= 5 %}
                        <span style='margin: 5px;font-size:17px;'>-</span>
                    {% endif %}
                    {% if (pageCourante - 3) < i and i < (pageCourante + 3) %}
                        {% if i == pageCourante %}
                            <span class="text-blue" style='margin:5px;'>{{ i }}</span>
                        {% else %}
                            <a href='index.php?action=post&page={{ i }}&id={{ post.id_post }}' style='margin:5px;text-decoration:none;'>{{ i }}</a>
                        {% endif %}
                    {% endif %}
                    {% if i == pagesTotales and pageCourante < (pagesTotales - 3) %}
                        <span style='margin:5px;'>-</span>
                    {% endif %}
                    {% if i == pagesTotales and pageCourante <= (pagesTotales - 3) %}
                        <a href='index.php?action=post&page={{ i }}&id={{ post.id_post }}' style='margin:5px;text-decoration:none;'>{{ i }}</a>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </p>

    </section>
{% endblock %}
